# 电商数仓数据指标文档

## 📊 数据概览

### 数据规模
- **订单数量**：可配置（默认50万）
- **时间跨度**：可配置（默认365天）
- **用户数量**：自动计算（订单数 ÷ 4）
- **商品数量**：约100款SPU，每款3-5个SKU
- **店铺数量**：可配置（支持多平台多店铺）

### 数据层级
```
ODS（原始数据层）
 ├─ 店铺、商品、用户
 ├─ 订单、订单明细
 ├─ 推广、流量、库存
 
DWD（明细数据层）
 ├─ 维度表：用户、商品、店铺、日期
 └─ 事实表：订单、订单明细、推广、流量、库存
 
DWS（汇总数据层）
 ├─ 日汇总、月汇总
 ├─ 店铺汇总、商品汇总
 └─ 用户汇总、类目汇总
 
ADS（应用数据层）
 └─ 业务报表、排行榜、趋势分析
```

---

## 🏪 商品体系

### SPU/SKU编码规则（中文编码）

**SPU编码格式：** `品牌类型-商品类型-序号`
- 示例：`品牌-公路车-01`、`白牌-山地车-03`

**SKU编码格式（整车）：** `SPU-车架-速别-尺寸-颜色`
- 示例：`品牌-公路车-01-铝架-21速-27寸-黑色`

**SKU编码格式（装备）：** `SPU-尺码-颜色`
- 示例：`品牌-头盔-02-M码-黑色`

### 商品分层策略（真实电商模型）

| 商品类型 | 占比 | 商品利润率 | 销量权重 | 特点 |
|---------|------|-----------|----------|------|
| **畅销品** | 30% | 28-33% | 3.0倍 | 走量商品，中等利润 |
| **利润品** | 20% | 40-50% | 0.5倍 | 高毛利，销量少 |
| **主推新品** | 15% | 28-35% | 1.5倍 | 中等利润，推广费高 |
| **滞销品** | 20% | 25-40% | 0.3倍 | 销量低，利润不稳定 |
| **引流品** | 15% | 20-25% | 4.0倍 | 高销量，低利润 |

### 不同类别利润率

| 商品类别 | 基础利润率 | 额外加成 | 最终利润率 |
|---------|-----------|---------|-----------|
| 品牌整车 | 28-33% | - | 28-33% |
| 白牌整车 | 28-33% | +5% | 33-38% |
| 品牌装备 | 28-33% | +10% | 38-43% |
| 白牌装备 | 28-33% | +15% | 43-48% |

**注**：商品利润率 = (售价 - 成本) / 售价，不含运费

---

## 💰 财务指标

### 利润结构
```
销售额 (100%)
  ├─ 成本 (60-65%)
  ├─ 运费 (3-5%)
  ├─ 毛利 (30-37%)
  │   ├─ 推广费 (5-8%)
  │   ├─ 售后费 (2%)
  │   ├─ 平台费 (5%)
  │   ├─ 管理费 (8%)
  │   └─ 净利润 (7-12%)
```

### 关键指标
- **毛利率**：30-37%（销售额 - 成本 - 运费）
- **推广费率**：5-8%
- **净利率**：7-12%（毛利 - 推广费 - 售后费 - 平台费 - 管理费）
- **客单价**：根据商品组合自动计算
- **复购率**：平均每用户4单

### 费用明细
- **售后费**：销售额的 2%
- **平台费**：销售额的 5%
- **管理费**：销售额的 8%
- **总运营费用**：20-23%（推广费 + 售后费 + 平台费 + 管理费）

---

## 📈 推广策略

### 推广覆盖
- **推广店铺占比**：80%
- **品牌店推广天数**：50%
- **白牌店推广天数**：35%
- **每天推广商品数**：2-3个

### 推广成本
- **整车类CPC**：1.2-2.0元
- **配件类CPC**：0.8-1.5元
- **最低日预算**：50元
- **曝光量**：5,000-20,000
- **点击率**：2-4%

---

## 📊 ODS层数据表

### 1. ods_stores（店铺表）
| 字段 | 类型 | 说明 |
|------|------|------|
| store_id | VARCHAR(20) | 店铺ID |
| store_name | VARCHAR(100) | 店铺名称（格式：【平台】店铺名） |
| store_type | VARCHAR(50) | 店铺类型（品牌/白牌） |
| platform | VARCHAR(20) | 平台（京东/天猫/抖音等） |
| open_date | DATE | 开店日期 |

### 2. ods_products（商品表）
| 字段 | 类型 | 说明 |
|------|------|------|
| product_id | VARCHAR(50) | SKU编码（中文） |
| spu_code | VARCHAR(20) | SPU编码（中文） |
| store_id | VARCHAR(20) | 店铺ID |
| platform | VARCHAR(20) | 平台 |
| product_name | VARCHAR(200) | 商品名称 |
| spec | VARCHAR(100) | 规格（中文） |
| category_l1 | VARCHAR(50) | 一级类目 |
| category_l2 | VARCHAR(50) | 二级类目 |
| price | DECIMAL(10,2) | 售价 |
| cost | DECIMAL(10,2) | 成本 |
| stock | INT | 库存 |
| create_time | DATETIME | 创建时间 |

### 3. ods_users（用户表）
| 字段 | 类型 | 说明 |
|------|------|------|
| user_id | VARCHAR(50) | 用户ID |
| user_name | VARCHAR(100) | 用户名 |
| gender | VARCHAR(10) | 性别 |
| age | INT | 年龄 |
| city | VARCHAR(50) | 城市 |
| register_date | DATE | 注册日期 |

### 4. ods_orders（订单表）
| 字段 | 类型 | 说明 |
|------|------|------|
| order_id | VARCHAR(20) | 订单ID |
| user_id | VARCHAR(50) | 用户ID |
| store_id | VARCHAR(20) | 店铺ID |
| platform | VARCHAR(20) | 平台 |
| order_time | DATETIME | 下单时间 |
| order_status | VARCHAR(20) | 订单状态（已完成92%/已取消6%/退款2%） |
| total_amount | DECIMAL(10,2) | 商品总额 |
| discount_amount | DECIMAL(10,2) | 优惠金额（固定0） |
| shipping_fee | DECIMAL(10,2) | 运费（买家包邮，商家承担） |
| final_amount | DECIMAL(10,2) | 实付金额 |
| total_cost | DECIMAL(10,2) | 成本总额 |
| payment_method | VARCHAR(20) | 支付方式 |
| create_time | DATETIME | 创建时间 |
| update_time | DATETIME | 更新时间 |

### 5. ods_order_details（订单明细表）
| 字段 | 类型 | 说明 |
|------|------|------|
| order_detail_id | VARCHAR(20) | 明细ID |
| order_id | VARCHAR(20) | 订单ID |
| product_id | VARCHAR(50) | SKU编码 |
| quantity | INT | 数量（1-3） |
| price | DECIMAL(10,2) | 单价 |
| amount | DECIMAL(12,2) | 金额 |

### 6. ods_promotion（推广表）
| 字段 | 类型 | 说明 |
|------|------|------|
| promotion_id | VARCHAR(20) | 推广ID |
| date | DATE | 日期 |
| store_id | VARCHAR(20) | 店铺ID |
| platform | VARCHAR(20) | 平台 |
| product_id | VARCHAR(50) | 商品ID |
| category_l1 | VARCHAR(50) | 一级类目 |
| category_l2 | VARCHAR(50) | 二级类目 |
| channel | VARCHAR(50) | 推广渠道 |
| cost | DECIMAL(10,2) | 推广花费 |
| impressions | INT | 曝光量 |
| clicks | INT | 点击量 |
| ctr | DECIMAL(5,2) | 点击率(%) |

### 7. ods_traffic（流量表）
| 字段 | 类型 | 说明 |
|------|------|------|
| date | DATE | 日期 |
| store_id | VARCHAR(20) | 店铺ID |
| platform | VARCHAR(20) | 平台 |
| visitors | INT | 访客数 |
| page_views | INT | 浏览量 |
| search_traffic | INT | 搜索流量 |
| recommend_traffic | INT | 推荐流量 |
| direct_traffic | INT | 直接访问 |
| other_traffic | INT | 其他流量 |
| avg_stay_time | DECIMAL(10,2) | 平均停留时长(秒) |
| bounce_rate | DECIMAL(5,2) | 跳失率(%) |

### 8. ods_inventory（库存表）
| 字段 | 类型 | 说明 |
|------|------|------|
| inventory_id | VARCHAR(20) | 库存记录ID |
| date | DATE | 日期 |
| product_id | VARCHAR(50) | 商品ID |
| store_id | VARCHAR(20) | 店铺ID |
| change_type | VARCHAR(20) | 变动类型（入库/出库） |
| change_quantity | INT | 变动数量 |
| stock_quantity | INT | 变动后库存 |
| remark | VARCHAR(100) | 备注 |

---

## 🎯 DWD层数据表

### 维度表

#### dim_date（日期维度）
- date_key（日期键，YYYYMMDD）
- year, quarter, month, week, day
- weekday, weekday_name, is_weekend
- year_month, year_week

#### dim_user（用户维度）
- user_key（代理键）
- user_id（业务键）
- user_name, gender, age, age_group
- city, register_date

#### dim_product（商品维度）
- product_key（代理键）
- product_id（SKU编码，中文）
- spu_code（SPU编码，中文）
- product_name, spec
- category_l1, category_l2
- price, cost, profit_margin
- store_id, platform

#### dim_store（店铺维度）
- store_key（代理键）
- store_id（业务键）
- store_name, platform, store_type
- open_date

### 事实表

#### dwd_fact_order（订单事实表）
- 包含订单主信息
- 关联用户、店铺维度
- 计算利润金额

#### dwd_fact_order_detail（订单明细事实表）
- 包含订单明细信息
- 关联用户、商品、店铺维度
- 计算成本、利润、利润率

#### dwd_fact_promotion（推广事实表）
- 包含推广投放数据
- 关联店铺、商品维度
- 计算CTR、CPC

#### dwd_fact_traffic（流量事实表）
- 包含店铺流量数据
- 关联店铺维度

#### dwd_fact_inventory（库存事实表）
- 包含库存变动记录
- 关联商品、店铺维度

---

## 📈 DWS层数据表

### 时间维度汇总
- **dws_sales_daily**：日汇总
- **dws_sales_monthly**：月汇总

### 店铺维度汇总
- **dws_store_daily**：店铺日汇总
- **dws_store_total**：店铺总汇总

### 商品维度汇总
- **dws_product_daily**：商品日汇总
- **dws_product_total**：商品总汇总

### 类目维度汇总
- **dws_category_daily**：类目日汇总
- **dws_category_total**：类目总汇总

### 用户维度汇总
- **dws_user_daily**：用户日汇总
- **dws_user_total**：用户总汇总

### 推广维度汇总
- **dws_promotion_daily**：推广日汇总
- **dws_promotion_product**：推广商品汇总

### 流量维度汇总
- **dws_traffic_daily**：流量日汇总

---

## 📊 ADS层数据表

### 1. ads_platform_report（平台对比分析）
- 各平台销售额、利润、用户数对比
- 销售额占比、利润占比
- 平均客单价

### 2. ads_top_products（TOP商品排行）
- 按销量、销售额、利润排行
- TOP 10/20/50

### 3. ads_category_analysis（类目分析）
- 各类目销售情况
- 类目占比、利润率

### 4. ads_user_level_analysis（用户等级分析）
- 用户分层（新用户/活跃用户/沉睡用户）
- 各层级贡献度

### 5. ads_monthly_trend（月度趋势）
- 月度销售趋势
- 同比、环比分析

### 6. ads_store_ranking（店铺排行榜）
- 店铺销售排名
- 综合排名、平台内排名

---

## ⚡ 性能指标

### 数据生成性能
- **50万订单生成**：15-20秒
- **100万明细生成**：同步完成
- **多进程加速**：20核并行，3.3万订单/秒

### 数据导入性能
- **ODS层导入**：50万订单 + 100万明细，约40秒
- **导入速度**：2-3万行/秒

### 数据转换性能（16GB内存 + 20核CPU）
- **DWD层转换**：90秒（1.5分钟）
  - 维度表构建：3秒
  - 订单事实表：25秒
  - 订单明细表：60秒
- **DWS层转换**：预计30-60秒
- **ADS层转换**：预计10-20秒

### 总体性能
- **完整数仓构建**：约3-4分钟（50万订单）
- **性能等级**：行业良好水平

---

## 🔧 配置说明

### 生成配置
```json
{
  "platformStores": {
    "京东": {"品牌": ["品牌旗舰店"], "白牌": ["白牌专营店1号", "白牌专营店2号"]},
    "天猫": {"品牌": ["品牌旗舰店"], "白牌": ["白牌专营店1号", "白牌专营店2号"]},
    "抖音": {"品牌": ["品牌旗舰店"], "白牌": ["白牌专营店1号"]},
    "快手": {"品牌": [], "白牌": ["白牌专营店1号", "白牌专营店2号"]},
    "拼多多": {"品牌": [], "白牌": ["白牌专营店1号", "白牌专营店2号", "白牌专营店3号"]}
  },
  "numOrders": 500000,
  "timeSpanDays": 1000,
  "mainCategory": "bicycle"
}
```

### 数据库配置
```json
{
  "host": "localhost",
  "port": 3306,
  "database": "datas",
  "user": "root",
  "password": ""
}
```

---

## 📝 数据特点

### 真实性
- ✅ 符合实际电商运营规律
- ✅ 商品分层策略（畅销品/利润品/引流品等）
- ✅ 合理的利润率分布（10-17%净利率）
- ✅ 真实的推广费用占比（5-8%）
- ✅ 符合实际的订单完成率（92%）

### 完整性
- ✅ 覆盖ODS/DWD/DWS/ADS四层
- ✅ 包含维度表和事实表
- ✅ 支持多维度分析

### 可扩展性
- ✅ 支持多平台多店铺
- ✅ 支持多种商品类目
- ✅ 支持自定义数据量
- ✅ 支持时间跨度配置

---

## 📚 使用场景

1. **数据仓库学习**：理解数仓分层架构
2. **SQL练习**：复杂查询、聚合、JOIN
3. **BI工具对接**：Tableau、PowerBI、DataV
4. **性能测试**：MySQL优化、索引优化
5. **数据分析**：电商业务分析、指标体系
6. **面试准备**：数仓项目经验

---

## 🎓 学习路径

### 初级
1. 理解ODS层原始数据
2. 学习基础SQL查询
3. 了解数据仓库概念

### 中级
1. 掌握DWD层维度建模
2. 学习事实表设计
3. 理解星型模型

### 高级
1. 掌握DWS层汇总设计
2. 学习ADS层应用设计
3. 性能优化和调优

---

**文档版本**：v2.0  
**更新日期**：2024-12-02  
**适用版本**：DatahouseBuilder v2.0+
